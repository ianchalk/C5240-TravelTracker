import{v as m}from"./chunk-GANIOWUT.js";import{c as d,r as g}from"./chunk-2RWO4YJT.js";var u=class p{autocompleteService=null;placesService=null;isGoogleMapsLoaded=!1;constructor(){this.loadGoogleMapsAPI()}loadGoogleMapsAPI(){return d(this,null,function*(){try{if(typeof google<"u"&&google.maps){this.initializeServices();return}let e=document.createElement("script");e.src=`https://maps.googleapis.com/maps/api/js?key=${m.googleMapsApiKey}&libraries=places`,e.async=!0,e.defer=!0;let t=new Promise((n,s)=>{e.onload=()=>{console.log("Google Maps API loaded successfully"),n()},e.onerror=o=>{console.error("Failed to load Google Maps API:",o),s(o)}});document.head.appendChild(e),yield t,this.initializeServices()}catch(e){console.error("Error loading Google Maps API:",e)}})}initializeServices(){try{if(typeof google<"u"&&google.maps&&google.maps.places){this.autocompleteService=new google.maps.places.AutocompleteService;let e=document.createElement("div"),t=new google.maps.Map(e);this.placesService=new google.maps.places.PlacesService(t),this.isGoogleMapsLoaded=!0,console.log("Google Places services initialized successfully")}else console.error("Google Maps API loaded but places library is not available")}catch(e){console.error("Error initializing Google Places services:",e)}}getPlacePredictions(e){return d(this,null,function*(){return new Promise((t,n)=>{if(!this.isGoogleMapsLoaded||!this.autocompleteService){console.warn("Google Maps not loaded yet"),t([]);return}if(!e||e.length<2){t([]);return}let s={input:e,types:["geocode","establishment"],componentRestrictions:void 0};this.autocompleteService.getPlacePredictions(s,(o,a)=>{if(a==="OK"&&o){let c=o.map(i=>({description:i.description,place_id:i.place_id,structured_formatting:{main_text:i.structured_formatting.main_text,secondary_text:i.structured_formatting.secondary_text||""},types:i.types}));t(c)}else console.warn("Places predictions failed:",a),t([])})})})}getPlaceDetails(e){return d(this,null,function*(){return new Promise((t,n)=>{if(!this.isGoogleMapsLoaded||!this.placesService){console.warn("Google Maps not loaded yet"),t(null);return}let s={placeId:e,fields:["formatted_address","geometry","name","place_id","types","address_components"]};this.placesService.getDetails(s,(o,a)=>{a==="OK"&&o?t(o):(console.warn("Place details failed:",a),t(null))})})})}convertPlaceToAddress(e){let t=e.address_components||[],n="",s="",o="",a="",c="",i="";return t.forEach(r=>{let l=r.types;l.includes("street_number")?n=r.long_name:l.includes("route")?s=r.long_name:l.includes("locality")||l.includes("administrative_area_level_2")?o=r.long_name:l.includes("administrative_area_level_1")?a=r.short_name:l.includes("country")?c=r.long_name:l.includes("postal_code")&&(i=r.long_name)}),{formatted_address:e.formatted_address||"",street_address:`${n} ${s}`.trim(),city:o,state:a,country:c,postal_code:i,coordinates:{lat:e.geometry?.location?.lat()||0,lng:e.geometry?.location?.lng()||0},place_id:e.place_id||"",types:e.types||[]}}isLoaded(){return this.isGoogleMapsLoaded}static \u0275fac=function(t){return new(t||p)};static \u0275prov=g({token:p,factory:p.\u0275fac,providedIn:"root"})};export{u as a};
